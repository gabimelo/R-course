test_set$american[test_set$american == FALSE] <- 0
test_set$american[test_set$american == TRUE] <- 1
test_set$white[test_set$white == FALSE] <- 0
test_set$white[test_set$white == TRUE] <- 1
test_set$married[test_set$married == FALSE] <- 0
test_set$married[test_set$married == TRUE] <- 1
test_set$primeage[test_set$primeage == FALSE] <- 0
test_set$primeage[test_set$primeage == TRUE] <- 1
test_set$male[test_set$male == FALSE] <- 0
test_set$male[test_set$male == TRUE] <- 1
test_set$over50k[test_set$over50k == FALSE] <- 0
test_set$over50k[test_set$over50k == TRUE] <- 1
classifier = rpart(formula = over50k ~ american + white + married + primeage + male, data = df)
y_pred = predict(classifier, newdata = test_set[-6], type = 'class')
training_set$over50k = factor(training_set$over50k, levels = c(0,1))
df$over50k = factor(df$over50k, levels = c(0,1))
test_set$over50k = factor(test_set$over50k, levels = c(0,1))
classifier = rpart(formula = over50k ~ american + white + married + primeage + male, data = df)
y_pred = predict(classifier, newdata = test_set[-6], type = 'class')
cm = table(test_set[,6], y_pred)
cm
plot(classifier)
text(classifier)
classifier
summary(df)
summary(test_set)
cnames <- c("age", "workclass", "fnlwgt", "education", "education.num", "marital.status",
"occupation", "relationship", "race", "sex", "capital.gain", "capital.loss",
"hours.per.week", "native.country", "income")
df <- read.csv("adult/adult.csv",col.names = cnames,header = FALSE)
test_set <- read.csv("adult/adult_test.csv", col.names = cnames,header = FALSE)
# columns with missing data:
table(df$workclass)
table(df$occupation)
table(df$native.country)
printPercentages <- function(column){
tab <- with(df, table(income, column))
print(prop.table(tab, margin = 1)*100)
tab <- with(df, table(column, income))
print(prop.table(tab, margin = 1)*100)
}
df$fnlwgt <- NULL
df$occupation <- NULL
df$capital.gain <- NULL
df$capital.loss <- NULL
test_set$fnlwgt <- NULL
test_set$occupation <- NULL
test_set$capital.gain <- NULL
test_set$capital.loss <- NULL
df$american[df$native.country!=" United-States"] <- FALSE
df$american[df$native.country==" United-States"] <- TRUE
df$native.country <- NULL
printPercentages(df$american)
test_set$american[test_set$native.country!=" United-States"] <- FALSE
test_set$american[test_set$native.country==" United-States"] <- TRUE
test_set$native.country <- NULL
printPercentages(df$sex)
df$overtime[df$hours.per.week > 60] <- "too much"
df$overtime[df$hours.per.week > 40 & df$hours.per.week <= 60] <- "overtime"
df$overtime[df$hours.per.week > 25 & df$hours.per.week <= 40] <- "full time"
df$overtime[df$hours.per.week <= 25] <- "part time"
df$hours.per.week <- NULL
printPercentages(df$overtime)
test_set$hours.per.week <- NULL
df$white[df$race == " White"] <- TRUE
df$white[df$race != " White"] <- FALSE
df$race <- NULL
printPercentages(df$white)
test_set$white[test_set$race == " White"] <- TRUE
test_set$white[test_set$race != " White"] <- FALSE
test_set$race <- NULL
df$married[df$relationship==" Husband" | df$relationship==" Wife"] <- TRUE
df$married[df$relationship!=" Husband" & df$relationship!=" Wife"] <- FALSE
df$relationship <- NULL
df$marital.status <- NULL
printPercentages(df$married)
test_set$married[test_set$relationship==" Husband" | test_set$relationship==" Wife"] <- TRUE
test_set$married[test_set$relationship!=" Husband" & test_set$relationship!=" Wife"] <- FALSE
test_set$relationship <- NULL
test_set$marital.status <- NULL
df$education = gsub("^10th","Dropout",df$education)
df$education = gsub("^11th","Dropout",df$education)
df$education = gsub("^12th","Dropout",df$education)
df$education = gsub("^1st-4th","Dropout",df$education)
df$education = gsub("^5th-6th","Dropout",df$education)
df$education = gsub("^7th-8th","Dropout",df$education)
df$education = gsub("^9th","Dropout",df$education)
df$education = gsub("^Assoc-acdm","Associates",df$education)
df$education = gsub("^Assoc-voc","Associates",df$education)
df$education = gsub("^Bachelors","Bachelors",df$education)
df$education = gsub("^Doctorate","Doctorate",df$education)
df$education = gsub("^HS-grad","HS-Graduate",df$education)
df$education = gsub("^Masters","Masters",df$education)
df$education = gsub("^Preschool","Dropout",df$education)
df$education = gsub("^Prof-school","Prof-School",df$education)
df$education = gsub("^Some-college","HS-Graduate",df$education)
printPercentages(df$education)
df$education.num <- NULL
test_set$education.num <- NULL
df$workclass = gsub("^Federal-gov","Govt",df$workclass)
df$workclass = gsub("^Local-gov","Govt",df$workclass)
df$workclass = gsub("^State-gov","Govt",df$workclass)
df$workclass = gsub("^Private","Private",df$workclass)
df$workclass = gsub("^Self-emp-inc","Self-Employed",df$workclass)
df$workclass = gsub("^Self-emp-not-inc","Self-Employed",df$workclass)
df$workclass = gsub("^Without-pay","Not-Working",df$workclass)
df$workclass = gsub("^Never-worked","Not-Working",df$workclass)
printPercentages(df$workclass)
df$age[df$age <= 30] <- "Young"
df$age[df$age > 30 & df$age <= 40] <- "Middle"
df$age[df$age > 40 & df$age <= 65] <- "Senior"
df$age[df$age > 65 & df$age <= 90] <- "Old"
printPercentages(df$age)
df$primeage[df$age == "Young" | df$age == "Old"] <- FALSE
df$primeage[df$age != "Young" & df$age != "Old"] <- TRUE
df$male[df$sex == " Male"] <- TRUE
df$male[df$sex == " Female"] <- FALSE
df$over50k[df$income == " <=50K"] <- FALSE
df$over50k[df$income == " >50K"] <- TRUE
df$income <- NULL
test_set$age[test_set$age <= 30] <- "Young"
test_set$age[test_set$age > 30 & test_set$age <= 40] <- "Middle"
test_set$age[test_set$age > 40 & test_set$age <= 65] <- "Senior"
test_set$age[test_set$age > 65 & test_set$age <= 90] <- "Old"
test_set$primeage[test_set$age == "Young" | test_set$age == "Old"] <- FALSE
test_set$primeage[test_set$age != "Young" & test_set$age != "Old"] <- TRUE
test_set$male[test_set$sex == " Male"] <- TRUE
test_set$male[test_set$sex == " Female"] <- FALSE
test_set$over50k[test_set$income == " <=50K."] <- FALSE
test_set$over50k[test_set$income == " >50K."] <- TRUE
test_set$income <- NULL
summary(df)
cor(df$married, df$over50k)
cor(df$primeage, df$over50k)
cor(df$male, df$over50k)
cor(df$white, df$over50k)
cor(df$american, df$over50k)
# selecionados: american (true), sex (male), white (true), married (true), age (30 < age <= 65)
df$age = NULL
df$workclass = NULL
df$education = NULL
df$sex = NULL
df$overtime = NULL
df$american[df$american == FALSE] <- 0
df$american[df$american == TRUE] <- 1
df$white[df$white == FALSE] <- 0
df$white[df$white == TRUE] <- 1
df$married[df$married == FALSE] <- 0
df$married[df$married == TRUE] <- 1
df$primeage[df$primeage == FALSE] <- 0
df$primeage[df$primeage == TRUE] <- 1
df$male[df$male == FALSE] <- 0
df$male[df$male == TRUE] <- 1
df$over50k[df$over50k == FALSE] <- 0
df$over50k[df$over50k == TRUE] <- 1
test_set$age = NULL
test_set$workclass = NULL
test_set$education = NULL
test_set$sex = NULL
test_set$american[test_set$american == FALSE] <- 0
test_set$american[test_set$american == TRUE] <- 1
test_set$white[test_set$white == FALSE] <- 0
test_set$white[test_set$white == TRUE] <- 1
test_set$married[test_set$married == FALSE] <- 0
test_set$married[test_set$married == TRUE] <- 1
test_set$primeage[test_set$primeage == FALSE] <- 0
test_set$primeage[test_set$primeage == TRUE] <- 1
test_set$male[test_set$male == FALSE] <- 0
test_set$male[test_set$male == TRUE] <- 1
test_set$over50k[test_set$over50k == FALSE] <- 0
test_set$over50k[test_set$over50k == TRUE] <- 1
df$over50k = factor(df$over50k, levels = c(0,1))
test_set$over50k = factor(test_set$over50k, levels = c(0,1))
classifier = rpart(formula = over50k ~ american + white + married + primeage + male, data = df)
y_pred = predict(classifier, newdata = test_set[-6], type = 'class')
cm = table(test_set[,6], y_pred)
cm
df$over50k = factor(df$over50k, levels = c(0,1))
df$american = factor(df$american, levels = c(0,1))
df$white = factor(df$white, levels = c(0,1))
df$male = factor(df$male, levels = c(0,1))
df$married = factor(df$married, levels = c(0,1))
df$primeage = factor(df$primeage, levels = c(0,1))
test_set$over50k = factor(test_set$over50k, levels = c(0,1))
test_set$american = factor(test_set$american, levels = c(0,1))
test_set$white = factor(test_set$white, levels = c(0,1))
test_set$male = factor(test_set$male, levels = c(0,1))
test_set$married = factor(test_set$married, levels = c(0,1))
test_set$primeage = factor(test_set$primeage, levels = c(0,1))
classifier = rpart(formula = over50k ~ american + white + married + primeage + male, data = df)
y_pred = predict(classifier, newdata = test_set[-6], type = 'class')
cm = table(test_set[,6], y_pred)
cm
cnames <- c("age", "workclass", "fnlwgt", "education", "education.num", "marital.status",
"occupation", "relationship", "race", "sex", "capital.gain", "capital.loss",
"hours.per.week", "native.country", "income")
df <- read.csv("adult/adult.csv",col.names = cnames,header = FALSE)
test_set <- read.csv("adult/adult_test.csv", col.names = cnames,header = FALSE)
# columns with missing data:
table(df$workclass)
table(df$occupation)
table(df$native.country)
printPercentages <- function(column){
tab <- with(df, table(income, column))
print(prop.table(tab, margin = 1)*100)
tab <- with(df, table(column, income))
print(prop.table(tab, margin = 1)*100)
}
df$fnlwgt <- NULL
df$occupation <- NULL
df$capital.gain <- NULL
df$capital.loss <- NULL
test_set$fnlwgt <- NULL
test_set$occupation <- NULL
test_set$capital.gain <- NULL
test_set$capital.loss <- NULL
df$american[df$native.country!=" United-States"] <- FALSE
df$american[df$native.country==" United-States"] <- TRUE
df$native.country <- NULL
printPercentages(df$american)
test_set$american[test_set$native.country!=" United-States"] <- FALSE
test_set$american[test_set$native.country==" United-States"] <- TRUE
test_set$native.country <- NULL
printPercentages(df$sex)
df$overtime[df$hours.per.week > 60] <- "too much"
df$overtime[df$hours.per.week > 40 & df$hours.per.week <= 60] <- "overtime"
df$overtime[df$hours.per.week > 25 & df$hours.per.week <= 40] <- "full time"
df$overtime[df$hours.per.week <= 25] <- "part time"
df$hours.per.week <- NULL
printPercentages(df$overtime)
test_set$hours.per.week <- NULL
df$white[df$race == " White"] <- TRUE
df$white[df$race != " White"] <- FALSE
df$race <- NULL
printPercentages(df$white)
test_set$white[test_set$race == " White"] <- TRUE
test_set$white[test_set$race != " White"] <- FALSE
test_set$race <- NULL
df$married[df$relationship==" Husband" | df$relationship==" Wife"] <- TRUE
df$married[df$relationship!=" Husband" & df$relationship!=" Wife"] <- FALSE
df$relationship <- NULL
df$marital.status <- NULL
printPercentages(df$married)
test_set$married[test_set$relationship==" Husband" | test_set$relationship==" Wife"] <- TRUE
test_set$married[test_set$relationship!=" Husband" & test_set$relationship!=" Wife"] <- FALSE
test_set$relationship <- NULL
test_set$marital.status <- NULL
df$education = gsub("^10th","Dropout",df$education)
df$education = gsub("^11th","Dropout",df$education)
df$education = gsub("^12th","Dropout",df$education)
df$education = gsub("^1st-4th","Dropout",df$education)
df$education = gsub("^5th-6th","Dropout",df$education)
df$education = gsub("^7th-8th","Dropout",df$education)
df$education = gsub("^9th","Dropout",df$education)
df$education = gsub("^Assoc-acdm","Associates",df$education)
df$education = gsub("^Assoc-voc","Associates",df$education)
df$education = gsub("^Bachelors","Bachelors",df$education)
df$education = gsub("^Doctorate","Doctorate",df$education)
df$education = gsub("^HS-grad","HS-Graduate",df$education)
df$education = gsub("^Masters","Masters",df$education)
df$education = gsub("^Preschool","Dropout",df$education)
df$education = gsub("^Prof-school","Prof-School",df$education)
df$education = gsub("^Some-college","HS-Graduate",df$education)
printPercentages(df$education)
df$education.num <- NULL
test_set$education.num <- NULL
df$workclass = gsub("^Federal-gov","Govt",df$workclass)
df$workclass = gsub("^Local-gov","Govt",df$workclass)
df$workclass = gsub("^State-gov","Govt",df$workclass)
df$workclass = gsub("^Private","Private",df$workclass)
df$workclass = gsub("^Self-emp-inc","Self-Employed",df$workclass)
df$workclass = gsub("^Self-emp-not-inc","Self-Employed",df$workclass)
df$workclass = gsub("^Without-pay","Not-Working",df$workclass)
df$workclass = gsub("^Never-worked","Not-Working",df$workclass)
printPercentages(df$workclass)
df$age[df$age <= 30] <- "Young"
df$age[df$age > 30 & df$age <= 40] <- "Middle"
df$age[df$age > 40 & df$age <= 65] <- "Senior"
df$age[df$age > 65 & df$age <= 90] <- "Old"
printPercentages(df$age)
df$primeage[df$age == "Young" | df$age == "Old"] <- FALSE
df$primeage[df$age != "Young" & df$age != "Old"] <- TRUE
df$male[df$sex == " Male"] <- TRUE
df$male[df$sex == " Female"] <- FALSE
df$over50k[df$income == " <=50K"] <- FALSE
df$over50k[df$income == " >50K"] <- TRUE
df$income <- NULL
test_set$age[test_set$age <= 30] <- "Young"
test_set$age[test_set$age > 30 & test_set$age <= 40] <- "Middle"
test_set$age[test_set$age > 40 & test_set$age <= 65] <- "Senior"
test_set$age[test_set$age > 65 & test_set$age <= 90] <- "Old"
test_set$primeage[test_set$age == "Young" | test_set$age == "Old"] <- FALSE
test_set$primeage[test_set$age != "Young" & test_set$age != "Old"] <- TRUE
test_set$male[test_set$sex == " Male"] <- TRUE
test_set$male[test_set$sex == " Female"] <- FALSE
test_set$over50k[test_set$income == " <=50K."] <- FALSE
test_set$over50k[test_set$income == " >50K."] <- TRUE
test_set$income <- NULL
summary(df)
cor(df$married, df$over50k)
cor(df$primeage, df$over50k)
cor(df$male, df$over50k)
cor(df$white, df$over50k)
cor(df$american, df$over50k)
# selecionados: american (true), sex (male), white (true), married (true), age (30 < age <= 65)
df$age = NULL
df$workclass = NULL
df$education = NULL
df$sex = NULL
df$overtime = NULL
table(df$american)
3391/(3391+29170)
select=c(ID, Weight))
newdata <- subset(df, american,
select=c(white))
table(newdata)
3549/29170
newdata <- subset(df, !american,
select=c(white))
table(newdata)
1196/3391
cptW = c(0.6, 0.4, 0.6, 0.4)
dim(cptW) = c(2, 2)
dimnames(cptW) = list("white" = c(0, 1), "american" =  c(0, 1))
cptW
cptW = c(0.35, 0.65, 0.12, 0.88)
dim(cptW) = c(2, 2)
dimnames(cptW) = list("white" = c(0, 1), "american" =  c(0, 1))
cptW
table(df$american)
table(df$male)
10771/32561
table(df$married)
17800/32561
cptMR = matrix(c(0.55, 0.45), ncol = 2, dimnames = list(NULL, c(0, 1)))
cptMR
table(df$primeage)
11730/32561
cptA = matrix(c(0.1, 0.9), ncol = 2, dimnames = list(NULL, c(0, 1)))
cptMR = matrix(c(0.55, 0.45), ncol = 2, dimnames = list(NULL, c(0, 1)))
cptML = matrix(c(0.33, 0.67), ncol = 2, dimnames = list(NULL, c(0, 1)))
cptP = matrix(c(0.36, 0.64), ncol = 2, dimnames = list(NULL, c(0, 1)))
cptW = c(0.35, 0.65, 0.12, 0.88)
dim(cptW) = c(2, 2)
dimnames(cptW) = list("white" = c(0, 1), "american" =  c(0, 1))
cptA
cptMR
cptML
cptP
cptW
cptO = c(0.6, 0.4, 0.6, 0.4, 0.6, 0.4, 0.6, 0.4, 0.6, 0.4, 0.6, 0.4, 0.6, 0.4, 0.6, 0.4, 0.6, 0.4, 0.6, 0.4, 0.6, 0.4, 0.6, 0.4, 0.6, 0.4, 0.6, 0.4, 0.6, 0.4, 0.6, 0.4)
dim(cptO) = c(2, 2, 2, 2, 2)
dimnames(cptO) = list("over50k" = c(0, 1), "white" =  c(0, 1), "male" =  c(0, 1), "married" =  c(0, 1), "primeage" =  c(0, 1))
cptO
newdata <- subset(df, !male & !married & !primeage & !white, select=c(over50k))
table(newdata)
735/738
sum = 738
newdata <- subset(df, !male & !married & !primeage & white, select=c(over50k))
table(newdata)
3458+58
sum = sum + 3516
3458/3516
newdata <- subset(df, male & !married & !primeage & !white, select=c(over50k))
table(newdata)
sum = sum + 730
705/730
newdata <- subset(df, male & !married & !primeage & white, select=c(over50k))
table(newdata)
3862+115
sum = sum + 3977
3862/3977
newdata <- subset(df, !male & married & !primeage & !white, select=c(over50k))
table(newdata)
sum = sum + 70
coun(newdata)
count(newdata)
a = 1
a = a + count(newdata)
a
table[0]
table["FALSE"]
table(newdata)[0]
table(newdata)["FALSE"]
a = a + table(newdata)["FALSE"]
a
newdata <- subset(df, !male & married & !primeage & !white, select=c(over50k))
table(newdata)
table(newdata)["FALSE"]/count(newdata)
50/70
newdata <- subset(df, !male & married & !primeage & white, select=c(over50k))
table(newdata)
sum = sum + count(newdata)
table(newdata)["FALSE"]/count(newdata)
newdata <- subset(df, male & married & !primeage & !white, select=c(over50k))
table(newdata)
sum = sum + count(newdata)
table(newdata)["FALSE"]/count(newdata)
newdata <- subset(df, male & married & !primeage & white, select=c(over50k))
table(newdata)
sum = sum + count(newdata)
table(newdata)["FALSE"]/count(newdata)
newdata <- subset(df, !male & !married & primeage & !white, select=c(over50k))
table(newdata)
sum = sum + count(newdata)
table(newdata)["FALSE"]/count(newdata)
newdata <- subset(df, !male & !married & primeage & white, select=c(over50k))
table(newdata)
sum = sum + count(newdata)
table(newdata)["FALSE"]/count(newdata)
newdata <- subset(df, male & !married & primeage & !white, select=c(over50k))
table(newdata)
sum = sum + count(newdata)
table(newdata)["FALSE"]/count(newdata)
newdata <- subset(df, male & !married & primeage & white, select=c(over50k))
table(newdata)
sum = sum + count(newdata)
table(newdata)["FALSE"]/count(newdata)
newdata <- subset(df, !male & married & primeage & !white, select=c(over50k))
table(newdata)
sum = sum + count(newdata)
table(newdata)["FALSE"]/count(newdata)
newdata <- subset(df, !male & married & primeage & white, select=c(over50k))
table(newdata)
sum = sum + count(newdata)
table(newdata)["FALSE"]/count(newdata)
newdata <- subset(df, male & married & primeage & !white, select=c(over50k))
table(newdata)
sum = sum + count(newdata)
table(newdata)["FALSE"]/count(newdata)
newdata <- subset(df, male & married & primeage & white, select=c(over50k))
table(newdata)
sum = sum + count(newdata)
table(newdata)["FALSE"]/count(newdata)
cptO = c(0.99, 0.01, 0.98, 0.02, 0.96, 0.04, 0.97, 0.03,
0.7, 0.3, 0.67, 0.03, 0.8, 0.2, 0.75, 0.25,
0.95, 0.05, 0.92, 0.08, 0.91, 0.09, 0.83, 0.17,
0.62, 0.38, 0.44, 0.56, 0.56, 0.44, 0.50, 0.50)
dim(cptO) = c(2, 2, 2, 2, 2)
dimnames(cptO) = list("over50k" = c(0, 1), "white" =  c(0, 1), "male" =  c(0, 1), "married" =  c(0, 1), "primeage" =  c(0, 1))
net = model2network("[american][white|american][male][married][primeage][over50k|white:male:married:primeage]")
dfit = custom.fit(net, dist = list(american = cptA, white = cptW, male = cptML, married = cptMR, primeage = cptP, over50k = cptO))
dfit
cptO
cptO = c(0.99, 0.01, 0.98, 0.02, 0.96, 0.04, 0.97, 0.03,
0.7, 0.3, 0.67, 0.33, 0.8, 0.2, 0.75, 0.25,
0.95, 0.05, 0.92, 0.08, 0.91, 0.09, 0.83, 0.17,
0.62, 0.38, 0.44, 0.56, 0.56, 0.44, 0.50, 0.50)
dim(cptO) = c(2, 2, 2, 2, 2)
dimnames(cptO) = list("over50k" = c(0, 1), "white" =  c(0, 1), "male" =  c(0, 1), "married" =  c(0, 1), "primeage" =  c(0, 1))
net = model2network("[american][white|american][male][married][primeage][over50k|white:male:married:primeage]")
dfit = custom.fit(net, dist = list(american = cptA, white = cptW, male = cptML, married = cptMR, primeage = cptP, over50k = cptO))
dfit
score(dag, df)
dag = model2network("[american][white|american][male][married][primeage][over50k|white:male:married:primeage]")
bn.fit(dag, df)
plot(dag)
df$american[df$american == FALSE] <- 0
df$american[df$american == TRUE] <- 1
df$white[df$white == FALSE] <- 0
df$white[df$white == TRUE] <- 1
df$married[df$married == FALSE] <- 0
df$married[df$married == TRUE] <- 1
df$primeage[df$primeage == FALSE] <- 0
df$primeage[df$primeage == TRUE] <- 1
df$male[df$male == FALSE] <- 0
df$male[df$male == TRUE] <- 1
df$over50k[df$over50k == FALSE] <- 0
df$over50k[df$over50k == TRUE] <- 1
test_set$age = NULL
test_set$workclass = NULL
test_set$education = NULL
test_set$sex = NULL
test_set$american[test_set$american == FALSE] <- 0
test_set$american[test_set$american == TRUE] <- 1
test_set$white[test_set$white == FALSE] <- 0
test_set$white[test_set$white == TRUE] <- 1
test_set$married[test_set$married == FALSE] <- 0
test_set$married[test_set$married == TRUE] <- 1
test_set$primeage[test_set$primeage == FALSE] <- 0
test_set$primeage[test_set$primeage == TRUE] <- 1
test_set$male[test_set$male == FALSE] <- 0
test_set$male[test_set$male == TRUE] <- 1
test_set$over50k[test_set$over50k == FALSE] <- 0
test_set$over50k[test_set$over50k == TRUE] <- 1
dag = model2network("[american][white|american][male][married][primeage][over50k|white:male:married:primeage]")
bn.fit(dag, df)
plot(dag)
pdag = iamb(df)
pdag
plot(pdag)
dag2 = set.arc(pdag, from = "married", to = "over50k")
dag2 = set.arc(dag2, from = "male", to = "over50k")
plot(dag2)
dag2 = set.arc(dag2, from = "married", to = "over50k")
plot(dag2)
dag2
dag2 = set.arc(dag2, from = "married", to = "over50k")
dag2 = set.arc(dag2, from = "married", to = "male")
dag2 = set.arc(dag2, from = "male", to = "married")
plot(dag2)
dag2
dag2 = set.arc(dag2, from = "married", to = "over50k")
plot(dag2)
fit = bn.fit(dag2, df)
pdag = iamb(df)
pdag
plot(pdag)
dag2 = set.arc(dag2, from = "male", to = "married")
plot(pdag)
plot(dag2)
dag2 = set.arc(dag2, from = "married", to = "over50k")
